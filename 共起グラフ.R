library(RMeCab)text <-  RMeCabFreq("merosu.txt")# 読み込み、解析。頻度表を作成。head(text)text_temp <- text[text$Info1 =="名詞" & text$Info2 == "一般" |text$Info1 =="動詞" & text$Info2 == "自立" |text$Info1 =="形容詞" & text$Info2 == "自立",]# 抽出できた。抽出条件もひとまず。これで。text_freq <- tail(text_temp[order(text_temp$Freq),],n=20)# トップ20を抽出。tailはどうかと思うから後で変更。text_freq[,1]# [1] "村"               "死ぬ"             "信じる"           "殴る"            # [5] "市"               "いい"             "出来る"           "妹"              # [9] "男"               "言う"             "セリヌンティウス" "殺す"            # [13] "王"               "友"               "人"               "走る"            # [17] "無い"             "なる"             "する"             "メロス"   top_text_freq <- text_freq[,1]# 共起度を計測 ここから適当。修正多し。# spanだから文単位じゃない、後で直す。# 更にループでもない、付け焼刃。後で直す。collocate("merosu.txt",node="メロス",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友"|word_merosu$Term=="人"|word_merosu$Term=="走る"|word_merosu$Term=="無い"|word_merosu$Term=="なる"|word_merosu$Term=="する",]collocate("merosu.txt",node="する",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友"|word_merosu$Term=="人"|word_merosu$Term=="走る"|word_merosu$Term=="無い"|word_merosu$Term=="なる",]collocate("merosu.txt",node="なる",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友"|word_merosu$Term=="人"|word_merosu$Term=="走る"|word_merosu$Term=="無い",]collocate("merosu.txt",node="無い",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友"|word_merosu$Term=="人"|word_merosu$Term=="走る",]collocate("merosu.txt",node="走る",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友"|word_merosu$Term=="人",]collocate("merosu.txt",node="人",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王"|word_merosu$Term=="友",]collocate("merosu.txt",node="友",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す"|word_merosu$Term=="王",]collocate("merosu.txt",node="王",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス"|word_merosu$Term=="殺す",]collocate("merosu.txt",node="殺す",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う"|word_merosu$Term=="セリヌンティウス",]collocate("merosu.txt",node="セリヌンティウス",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男"|word_merosu$Term=="言う",]collocate("merosu.txt",node="言う",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹"|word_merosu$Term=="男",]collocate("merosu.txt",node="男",span=5)word_merosu <- as.data.frame(collocate("merosu.txt",node="メロス",span=5)[c(T,F,F,T,F)])word_merosu <- word_merosu[word_merosu$Term=="村"|word_merosu$Term=="死ぬ"|word_merosu$Term=="信じる"|word_merosu$Term=="殴る"|word_merosu$Term=="市"|word_merosu$Term=="いい"|word_merosu$Term=="出来る"|word_merosu$Term=="妹",]